<ion-content class="ion-no-padding">
    <div class="app-layout">
      <!-- Contenuto principale -->
      <div class="main-container" [class.sidebar-closed]="!sidebarExpanded()">
        
        <!-- Stato di caricamento -->
        @if (isLoading()) {
          <div class="loading-container">
            <ion-spinner name="crescent" color="primary"></ion-spinner>
            <ion-text color="medium">
              <p>Caricamento calendario...</p>
            </ion-text>
          </div>
        }
        
        <!-- Stato di errore -->
        @else if (getError()) {
          <div class="error-container">
            <ion-text color="danger">
              <h2>‚ö†Ô∏è Errore</h2>
              <p>{{ getError() }}</p>
            </ion-text>
            <ion-button fill="solid" color="primary" (click)="reload()">
              üîÑ Riprova
            </ion-button>
          </div>
        }
        
        <!-- Calendario principale -->
        @else {
          <app-calendar-board 
            [days]="days()" 
            [tasksByDay]="tasksByDay()" 
            [householdId]="householdId || ''"
            [initialView]="currentView()"
            [timeWindowInput]="timeWindowData()"
            [activeKidProfile]="getActiveKidProfile()"
            (taskDone)="onTaskDone($event)"
            (viewChanged)="onViewChanged($event)"
            (dateChanged)="onDateChanged($event)">
          </app-calendar-board>
        }
        
      </div>

      <!-- Pulsante toggle sidebar -->
      <div class="sidebar-toggle" [class.sidebar-closed]="!sidebarExpanded()">
        <ion-button fill="solid" size="small" color="white" (click)="toggleSidebar()" class="toggle-btn">
          @if (sidebarExpanded()) {
          <span class="toggle-icon">‚úñÔ∏è</span>
          } @else {
          <span class="toggle-icon">‚öôÔ∏è</span>
          }
        </ion-button>
      </div>

      <!-- Sidebar che si chiude completamente -->
      @if (sidebarExpanded()) {
      <div class="sidebar-container">
        <app-account-sidebar (closeSidebar)="toggleSidebar()"></app-account-sidebar>
      </div>
      }
    </div>
  </ion-content>